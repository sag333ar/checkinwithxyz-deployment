var Gt=Object.defineProperty;var kt=(r,e,t)=>e in r?Gt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var L=(r,e,t)=>kt(r,typeof e!="symbol"?e+"":e,t);import{a as ut}from"./index-DWlDCpRe.js";var Ne={exports:{}},H=typeof Reflect=="object"?Reflect:null,Ce=H&&typeof H.apply=="function"?H.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},oe;H&&typeof H.ownKeys=="function"?oe=H.ownKeys:Object.getOwnPropertySymbols?oe=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:oe=function(e){return Object.getOwnPropertyNames(e)};function jt(r){console&&console.warn&&console.warn(r)}var ft=Number.isNaN||function(e){return e!==e};function T(){T.init.call(this)}Ne.exports=T;Ne.exports.once=qt;T.EventEmitter=T;T.prototype._events=void 0;T.prototype._eventsCount=0;T.prototype._maxListeners=void 0;var De=10;function ae(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(T,"defaultMaxListeners",{enumerable:!0,get:function(){return De},set:function(r){if(typeof r!="number"||r<0||ft(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");De=r}});T.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};T.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ft(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ht(r){return r._maxListeners===void 0?T.defaultMaxListeners:r._maxListeners}T.prototype.getMaxListeners=function(){return ht(this)};T.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var s=e==="error",o=this._events;if(o!==void 0)s=s&&o.error===void 0;else if(!s)return!1;if(s){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var u=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw u.context=i,u}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")Ce(c,this,t);else for(var v=c.length,a=vt(c,v),n=0;n<v;++n)Ce(a[n],this,t);return!0};function dt(r,e,t,n){var s,o,i;if(ae(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),i=o[e]),i===void 0)i=o[e]=t,++r._eventsCount;else if(typeof i=="function"?i=o[e]=n?[t,i]:[i,t]:n?i.unshift(t):i.push(t),s=ht(r),s>0&&i.length>s&&!i.warned){i.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=r,u.type=e,u.count=i.length,jt(u)}return r}T.prototype.addListener=function(e,t){return dt(this,e,t,!1)};T.prototype.on=T.prototype.addListener;T.prototype.prependListener=function(e,t){return dt(this,e,t,!0)};function Vt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Et(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},s=Vt.bind(n);return s.listener=t,n.wrapFn=s,s}T.prototype.once=function(e,t){return ae(t),this.on(e,Et(this,e,t)),this};T.prototype.prependOnceListener=function(e,t){return ae(t),this.prependListener(e,Et(this,e,t)),this};T.prototype.removeListener=function(e,t){var n,s,o,i,u;if(ae(t),s=this._events,s===void 0)return this;if(n=s[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){u=n[i].listener,o=i;break}if(o<0)return this;o===0?n.shift():Xt(n,o),n.length===1&&(s[e]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",e,u||t)}return this};T.prototype.off=T.prototype.removeListener;T.prototype.removeAllListeners=function(e){var t,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),i;for(s=0;s<o.length;++s)i=o[s],i!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this};function pt(r,e,t){var n=r._events;if(n===void 0)return[];var s=n[e];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?Ht(s):vt(s,s.length)}T.prototype.listeners=function(e){return pt(this,e,!0)};T.prototype.rawListeners=function(e){return pt(this,e,!1)};T.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):mt.call(r,e)};T.prototype.listenerCount=mt;function mt(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}T.prototype.eventNames=function(){return this._eventsCount>0?oe(this._events):[]};function vt(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Xt(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Ht(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function qt(r,e){return new Promise(function(t,n){function s(i){r.removeListener(e,o),n(i)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",s),t([].slice.call(arguments))}gt(r,e,o,{once:!0}),e!=="error"&&zt(r,s,{once:!0})})}function zt(r,e,t){typeof r.on=="function"&&gt(r,"error",e,t)}function gt(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function s(o){n.once&&r.removeEventListener(e,s),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var Wt=Ne.exports;const Kt=ut(Wt),Yt={},Zt={},It=(r,e)=>{Zt[r]=e},l=r=>{class e extends Error{constructor(s,o,i){super(s||r,i);L(this,"cause");if(Object.setPrototypeOf(this,e.prototype),this.name=r,o)for(const u in o)this[u]=o[u];if(i&&Qt(i)&&"cause"in i&&!this.cause){const u=i.cause;this.cause=u,"stack"in u&&(this.stack=this.stack+`
CAUSE: `+u.stack)}}}return Yt[r]=e,e};function Qt(r){return typeof r=="object"}l("AccountNameRequired");l("AccountNotSupported");l("AccountAwaitingSendPendingOperations");l("AmountRequired");l("BluetoothRequired");l("BtcUnmatchedApp");l("CantOpenDevice");l("CashAddrNotSupported");l("ClaimRewardsFeesWarning");l("CurrencyNotSupported");l("DeviceAppVerifyNotSupported");l("DeviceGenuineSocketEarlyClose");l("DeviceNotGenuine");l("DeviceOnDashboardExpected");l("DeviceOnDashboardUnexpected");l("DeviceInOSUExpected");l("DeviceHalted");l("DeviceNameInvalid");l("DeviceSocketFail");l("DeviceSocketNoBulkStatus");l("DeviceSocketNoBulkStatus");l("UnresponsiveDeviceError");const Jt=l("DisconnectedDevice"),er=l("DisconnectedDeviceDuringOperation");l("DeviceExtractOnboardingStateError");l("DeviceOnboardingStatePollingError");l("EnpointConfig");l("EthAppPleaseEnableContractData");l("FeeEstimationFailed");l("FirmwareNotRecognized");l("HardResetFail");l("InvalidXRPTag");l("InvalidAddress");l("InvalidNonce");l("InvalidAddressBecauseDestinationIsAlsoSource");l("LatestMCUInstalledError");l("LatestFirmwareVersionRequired");l("UnknownMCU");l("LedgerAPIError");l("LedgerAPIErrorWithMessage");l("LedgerAPINotAvailable");l("ManagerAppAlreadyInstalled");l("ManagerAppRelyOnBTC");l("ManagerAppDepInstallRequired");l("ManagerAppDepUninstallRequired");l("ManagerDeviceLocked");l("ManagerFirmwareNotEnoughSpace");l("ManagerNotEnoughSpace");l("ManagerUninstallBTCDep");l("NetworkDown");l("NetworkError");l("NoAddressesFound");l("NotEnoughBalance");l("NotEnoughBalanceFees");l("NotEnoughBalanceSwap");l("NotEnoughBalanceToDelegate");l("UnstakeNotEnoughStakedBalanceLeft");l("RestakeNotEnoughStakedBalanceLeft");l("NotEnoughToRestake");l("NotEnoughToUnstake");l("NotEnoughBalanceInParentAccount");l("NotEnoughSpendableBalance");l("NotEnoughBalanceBecauseDestinationNotCreated");l("NotEnoughToStake");l("NoAccessToCamera");l("NotEnoughGas");l("NotEnoughGasSwap");l("TronEmptyAccount");l("MaybeKeepTronAccountAlive");l("NotSupportedLegacyAddress");l("GasLessThanEstimate");l("PriorityFeeTooLow");l("PriorityFeeTooHigh");l("PriorityFeeHigherThanMaxFee");l("MaxFeeTooLow");l("PasswordsDontMatch");l("PasswordIncorrect");l("RecommendSubAccountsToEmpty");l("RecommendUndelegation");l("TimeoutTagged");l("UnexpectedBootloader");l("MCUNotGenuineToDashboard");l("RecipientRequired");l("UnavailableTezosOriginatedAccountReceive");l("UnavailableTezosOriginatedAccountSend");l("UpdateFetchFileFail");l("UpdateIncorrectHash");l("UpdateIncorrectSig");l("UpdateYourApp");l("UserRefusedDeviceNameChange");l("UserRefusedAddress");l("UserRefusedFirmwareUpdate");l("UserRefusedAllowManager");l("UserRefusedOnDevice");l("PinNotSet");l("ExpertModeRequired");const tr=l("TransportOpenUserCancelled"),Pe=l("TransportInterfaceNotAvailable"),rr=l("TransportRaceCondition"),nr=l("TransportWebUSBGestureRequired");l("TransactionHasBeenValidatedError");l("TransportExchangeTimeoutError");l("DeviceShouldStayInApp");l("WebsocketConnectionError");l("WebsocketConnectionFailed");l("WrongDeviceForAccount");l("WrongDeviceForAccountPayout");l("MissingSwapPayloadParamaters");l("WrongDeviceForAccountRefund");l("WrongAppForCurrency");l("ETHAddressNonEIP");l("CantScanQRCode");l("FeeNotLoaded");l("FeeNotLoadedSwap");l("FeeRequired");l("FeeTooHigh");l("PendingOperation");l("SyncError");l("PairingFailed");l("PeerRemovedPairing");l("GenuineCheckFailed");l("LedgerAPI4xx");l("LedgerAPI5xx");l("FirmwareOrAppUpdateRequired");l("ReplacementTransactionUnderpriced");l("OpReturnSizeLimit");l("DustLimit");l("LanguageNotFound");l("NoDBPathGiven");l("DBWrongPassword");l("DBNotReset");l("SequenceNumberError");l("DisabledTransactionBroadcastError");var be;(function(r){r.Unknown="Unknown",r.LocationServicesDisabled="LocationServicesDisabled",r.LocationServicesUnauthorized="LocationServicesUnauthorized",r.BluetoothScanStartFailed="BluetoothScanStartFailed"})(be||(be={}));class k extends Error{constructor(t,n){const s="TransportError";super(t||s);L(this,"id");this.name=s,this.message=t,this.stack=new Error(t).stack,this.id=n}}It("TransportError",r=>new k(r.message,r.id));const q={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,DEVICE_IN_RECOVERY_MODE:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738,APP_NOT_FOUND_OR_INVALID_CONTEXT:20771,INVALID_APP_NAME_LENGTH:26378,GEN_AES_KEY_FAILED:21529,INTERNAL_CRYPTO_OPERATION_FAILED:21530,INTERNAL_COMPUTE_AES_CMAC_FAILED:21531,ENCRYPT_APP_STORAGE_FAILED:21532,INVALID_BACKUP_STATE:26178,PIN_NOT_SET:21762,INVALID_BACKUP_LENGTH:26419,INVALID_RESTORE_STATE:26179,INVALID_CHUNK_LENGTH:26420,INVALID_BACKUP_HEADER:26698,TRUSTCHAIN_WRONG_SEED:45063};function sr(r){switch(r){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=r&&r<=28671)return"Internal error, please report"}class z extends Error{constructor(t,{canBeMappedToChildError:n=!0}={}){const s=Object.keys(q).find(c=>q[c]===t)||"UNKNOWN_ERROR",o=sr(t)||s,i=t.toString(16),u=`Ledger device: ${o} (0x${i})`;super(u);L(this,"statusCode");L(this,"statusText");if(this.name="TransportStatusError",this.statusCode=t,this.statusText=s,Object.setPrototypeOf(this,z.prototype),n&&t===q.LOCKED_DEVICE)return new Le(u)}}class Le extends z{constructor(e){super(q.LOCKED_DEVICE,{canBeMappedToChildError:!1}),e&&(this.message=e),this.name="LockedDeviceError",Object.setPrototypeOf(this,Le.prototype)}}It("TransportStatusError",r=>new z(r.statusCode));let Rt=0;const B=[],Ue=(r,e,t)=>{const n={type:r,id:String(++Rt),date:new Date};e&&(n.message=e),$t(n)},ir=({type:r,message:e,data:t,context:n})=>{const s={type:r,id:String(++Rt),date:new Date};e&&(s.message=e),t&&(s.data=t),n&&(s.context=n),$t(s)};class Q{constructor(e,t){L(this,"type");L(this,"context");this.type=e,this.context=t}trace(e,t){ir({type:this.type,message:e,data:t,context:this.context})}getContext(){return this.context}setContext(e){this.context=e}updateContext(e){this.context={...this.context,...e}}getType(){return this.type}setType(e){this.type=e}withType(e){return new Q(e,this.context)}withContext(e){return new Q(this.type,e)}withUpdatedContext(e){return new Q(this.type,{...this.context,...e})}}const or=r=>(B.push(r),()=>{const e=B.indexOf(r);e!==-1&&(B[e]=B[B.length-1],B.pop())});function $t(r){for(let e=0;e<B.length;e++)try{B[e](r)}catch(t){console.error(t)}}typeof window<"u"&&(window.__ledgerLogsListen=or);const ar="transport";class V{constructor({context:e,logType:t}={}){L(this,"exchangeTimeout",3e4);L(this,"unresponsiveTimeout",15e3);L(this,"deviceModel",null);L(this,"tracer");L(this,"_events",new Kt);L(this,"send",async(e,t,n,s,o=Buffer.alloc(0),i=[q.OK],{abortTimeoutMs:u}={})=>{const c=this.tracer.withUpdatedContext({function:"send"});if(o.length>=256)throw c.trace("data.length exceeded 256 bytes limit",{dataLength:o.length}),new k("data.length exceed 256 bytes limit. Got: "+o.length,"DataLengthTooBig");c.trace("Starting an exchange",{abortTimeoutMs:u});const v=await this.exchange(Buffer.concat([Buffer.from([e,t,n,s]),Buffer.from([o.length]),o]),{abortTimeoutMs:u});c.trace("Received response from exchange");const a=v.readUInt16BE(v.length-2);if(!i.some(d=>d===a))throw new z(a);return v});L(this,"exchangeBusyPromise");L(this,"_appAPIlock",null);this.tracer=new Q(t??ar,e)}exchange(e,{abortTimeoutMs:t}={}){throw new Error("exchange not implemented")}exchangeBulk(e,t){let n=!1;const s=()=>{n=!0};return(async()=>{if(!n)for(const i of e){const u=await this.exchange(i);if(n)return;const c=u.readUInt16BE(u.length-2);if(c!==q.OK)throw new z(c);t.next(u)}})().then(()=>!n&&t.complete(),i=>!n&&t.error(i)),{unsubscribe:s}}setScrambleKey(e){}close(){return Promise.resolve()}on(e,t){this._events.on(e,t)}off(e,t){this._events.removeListener(e,t)}emit(e,...t){this._events.emit(e,...t)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(e){this.exchangeTimeout=e}setExchangeUnresponsiveTimeout(e){this.unresponsiveTimeout=e}static create(e=3e3,t){return new Promise((n,s)=>{let o=!1;const i=this.listen({next:c=>{o=!0,i&&i.unsubscribe(),u&&clearTimeout(u),this.open(c.descriptor,e).then(n,s)},error:c=>{u&&clearTimeout(u),s(c)},complete:()=>{u&&clearTimeout(u),o||s(new k(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),u=t?setTimeout(()=>{i.unsubscribe(),s(new k(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},t):null})}async exchangeAtomicImpl(e){const t=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw t.trace("Atomic exchange is already busy"),new rr("An action was already pending on the Ledger device. Please deny or reconnect.");let n;const s=new Promise(u=>{n=u});this.exchangeBusyPromise=s;let o=!1;const i=setTimeout(()=>{t.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),o=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const u=await e();return o&&(t.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),u}finally{t.trace("Finalize, clearing busy guard"),clearTimeout(i),n&&n(),this.exchangeBusyPromise=null}}decorateAppAPIMethods(e,t,n){for(const s of t)e[s]=this.decorateAppAPIMethod(s,e[s],e,n)}decorateAppAPIMethod(e,t,n,s){return async(...o)=>{const{_appAPIlock:i}=this;if(i)return Promise.reject(new k("Ledger Device is busy (lock "+i+")","TransportLocked"));try{return this._appAPIlock=e,this.setScrambleKey(s),await t.apply(n,o)}finally{this._appAPIlock=null}}}setTraceContext(e){this.tracer=this.tracer.withContext(e)}updateTraceContext(e){this.tracer.updateContext(e)}getTraceContext(){return this.tracer.getContext()}}L(V,"isSupported"),L(V,"list"),L(V,"listen"),L(V,"open"),L(V,"ErrorMessage_ListenTimeout","No Ledger device found (timeout)"),L(V,"ErrorMessage_NoDeviceFound","No Ledger device found");const Fe=5;function cr(r){const e=Buffer.alloc(2);return e.writeUInt16BE(r,0),e}const lr={data:Buffer.alloc(0),dataLength:0,sequence:0},ur=(r,e)=>({makeBlocks(t){let n=Buffer.concat([cr(t.length),t]);const s=e-5,o=Math.ceil(n.length/s);n=Buffer.concat([n,Buffer.alloc(o*s-n.length+1).fill(0)]);const i=[];for(let u=0;u<o;u++){const c=Buffer.alloc(5);c.writeUInt16BE(r,0),c.writeUInt8(Fe,2),c.writeUInt16BE(u,3);const v=n.slice(u*s,(u+1)*s);i.push(Buffer.concat([c,v]))}return i},reduceResponse(t,n){let{data:s,dataLength:o,sequence:i}=t||lr;if(n.readUInt16BE(0)!==r)throw new k("Invalid channel","InvalidChannel");if(n.readUInt8(2)!==Fe)throw new k("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==i)throw new k("Invalid sequence","InvalidSequence");t||(o=n.readUInt16BE(5)),i++;const u=n.slice(t?5:7);return s=Buffer.concat([s,u]),s.length>o&&(s=s.slice(0,o)),{data:s,dataLength:o,sequence:i}},getReducedResult(t){if(t&&t.dataLength===t.data.length)return t.data}});var Ie={exports:{}};const fr="2.0.0",Nt=256,hr=Number.MAX_SAFE_INTEGER||9007199254740991,dr=16,Er=Nt-6,pr=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var ce={MAX_LENGTH:Nt,MAX_SAFE_COMPONENT_LENGTH:dr,MAX_SAFE_BUILD_LENGTH:Er,MAX_SAFE_INTEGER:hr,RELEASE_TYPES:pr,SEMVER_SPEC_VERSION:fr,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},de={};const mr=typeof process=="object"&&de&&de.NODE_DEBUG&&/\bsemver\b/i.test(de.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};var le=mr;(function(r,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=ce,o=le;e=r.exports={};const i=e.re=[],u=e.safeRe=[],c=e.src=[],v=e.safeSrc=[],a=e.t={};let d=0;const S="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",s],[S,n]],K=F=>{for(const[D,j]of m)F=F.split(`${D}*`).join(`${D}{0,${j}}`).split(`${D}+`).join(`${D}{1,${j}}`);return F},R=(F,D,j)=>{const x=K(D),M=d++;o(F,M,D),a[F]=M,c[M]=D,v[M]=x,i[M]=new RegExp(D,j?"g":void 0),u[M]=new RegExp(x,j?"g":void 0)};R("NUMERICIDENTIFIER","0|[1-9]\\d*"),R("NUMERICIDENTIFIERLOOSE","\\d+"),R("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${S}*`),R("MAINVERSION",`(${c[a.NUMERICIDENTIFIER]})\\.(${c[a.NUMERICIDENTIFIER]})\\.(${c[a.NUMERICIDENTIFIER]})`),R("MAINVERSIONLOOSE",`(${c[a.NUMERICIDENTIFIERLOOSE]})\\.(${c[a.NUMERICIDENTIFIERLOOSE]})\\.(${c[a.NUMERICIDENTIFIERLOOSE]})`),R("PRERELEASEIDENTIFIER",`(?:${c[a.NONNUMERICIDENTIFIER]}|${c[a.NUMERICIDENTIFIER]})`),R("PRERELEASEIDENTIFIERLOOSE",`(?:${c[a.NONNUMERICIDENTIFIER]}|${c[a.NUMERICIDENTIFIERLOOSE]})`),R("PRERELEASE",`(?:-(${c[a.PRERELEASEIDENTIFIER]}(?:\\.${c[a.PRERELEASEIDENTIFIER]})*))`),R("PRERELEASELOOSE",`(?:-?(${c[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[a.PRERELEASEIDENTIFIERLOOSE]})*))`),R("BUILDIDENTIFIER",`${S}+`),R("BUILD",`(?:\\+(${c[a.BUILDIDENTIFIER]}(?:\\.${c[a.BUILDIDENTIFIER]})*))`),R("FULLPLAIN",`v?${c[a.MAINVERSION]}${c[a.PRERELEASE]}?${c[a.BUILD]}?`),R("FULL",`^${c[a.FULLPLAIN]}$`),R("LOOSEPLAIN",`[v=\\s]*${c[a.MAINVERSIONLOOSE]}${c[a.PRERELEASELOOSE]}?${c[a.BUILD]}?`),R("LOOSE",`^${c[a.LOOSEPLAIN]}$`),R("GTLT","((?:<|>)?=?)"),R("XRANGEIDENTIFIERLOOSE",`${c[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),R("XRANGEIDENTIFIER",`${c[a.NUMERICIDENTIFIER]}|x|X|\\*`),R("XRANGEPLAIN",`[v=\\s]*(${c[a.XRANGEIDENTIFIER]})(?:\\.(${c[a.XRANGEIDENTIFIER]})(?:\\.(${c[a.XRANGEIDENTIFIER]})(?:${c[a.PRERELEASE]})?${c[a.BUILD]}?)?)?`),R("XRANGEPLAINLOOSE",`[v=\\s]*(${c[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[a.XRANGEIDENTIFIERLOOSE]})(?:${c[a.PRERELEASELOOSE]})?${c[a.BUILD]}?)?)?`),R("XRANGE",`^${c[a.GTLT]}\\s*${c[a.XRANGEPLAIN]}$`),R("XRANGELOOSE",`^${c[a.GTLT]}\\s*${c[a.XRANGEPLAINLOOSE]}$`),R("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),R("COERCE",`${c[a.COERCEPLAIN]}(?:$|[^\\d])`),R("COERCEFULL",c[a.COERCEPLAIN]+`(?:${c[a.PRERELEASE]})?(?:${c[a.BUILD]})?(?:$|[^\\d])`),R("COERCERTL",c[a.COERCE],!0),R("COERCERTLFULL",c[a.COERCEFULL],!0),R("LONETILDE","(?:~>?)"),R("TILDETRIM",`(\\s*)${c[a.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",R("TILDE",`^${c[a.LONETILDE]}${c[a.XRANGEPLAIN]}$`),R("TILDELOOSE",`^${c[a.LONETILDE]}${c[a.XRANGEPLAINLOOSE]}$`),R("LONECARET","(?:\\^)"),R("CARETTRIM",`(\\s*)${c[a.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",R("CARET",`^${c[a.LONECARET]}${c[a.XRANGEPLAIN]}$`),R("CARETLOOSE",`^${c[a.LONECARET]}${c[a.XRANGEPLAINLOOSE]}$`),R("COMPARATORLOOSE",`^${c[a.GTLT]}\\s*(${c[a.LOOSEPLAIN]})$|^$`),R("COMPARATOR",`^${c[a.GTLT]}\\s*(${c[a.FULLPLAIN]})$|^$`),R("COMPARATORTRIM",`(\\s*)${c[a.GTLT]}\\s*(${c[a.LOOSEPLAIN]}|${c[a.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",R("HYPHENRANGE",`^\\s*(${c[a.XRANGEPLAIN]})\\s+-\\s+(${c[a.XRANGEPLAIN]})\\s*$`),R("HYPHENRANGELOOSE",`^\\s*(${c[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[a.XRANGEPLAINLOOSE]})\\s*$`),R("STAR","(<|>)?=?\\s*\\*"),R("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),R("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Ie,Ie.exports);var J=Ie.exports;const vr=Object.freeze({loose:!0}),gr=Object.freeze({}),Ir=r=>r?typeof r!="object"?vr:r:gr;var Se=Ir;const Me=/^[0-9]+$/,Lt=(r,e)=>{const t=Me.test(r),n=Me.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},Rr=(r,e)=>Lt(e,r);var St={compareIdentifiers:Lt,rcompareIdentifiers:Rr};const ee=le,{MAX_LENGTH:Be,MAX_SAFE_INTEGER:te}=ce,{safeRe:re,t:ne}=J,$r=Se,{compareIdentifiers:X}=St;let Nr=class U{constructor(e,t){if(t=$r(t),e instanceof U){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Be)throw new TypeError(`version is longer than ${Be} characters`);ee("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?re[ne.LOOSE]:re[ne.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>te||this.major<0)throw new TypeError("Invalid major version");if(this.minor>te||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>te||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){const o=+s;if(o>=0&&o<te)return o}return s}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(ee("SemVer.compare",this.version,this.options,e),!(e instanceof U)){if(typeof e=="string"&&e===this.version)return 0;e=new U(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof U||(e=new U(e,this.options)),X(this.major,e.major)||X(this.minor,e.minor)||X(this.patch,e.patch)}comparePre(e){if(e instanceof U||(e=new U(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],s=e.prerelease[t];if(ee("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return X(n,s)}while(++t)}compareBuild(e){e instanceof U||(e=new U(e,this.options));let t=0;do{const n=this.build[t],s=e.build[t];if(ee("build compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return X(n,s)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(t){const s=`-${t}`.match(this.options.loose?re[ne.PRERELEASELOOSE]:re[ne.PRERELEASE]);if(!s||s[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const s=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[s];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(t){let o=[t,s];n===!1&&(o=[t]),X(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var y=Nr;const Ge=y,Lr=(r,e,t=!1)=>{if(r instanceof Ge)return r;try{return new Ge(r,e)}catch(n){if(!t)return null;throw n}};var W=Lr;const Sr=W,Or=(r,e)=>{const t=Sr(r,e);return t?t.version:null};var Tr=Or;const Ar=W,wr=(r,e)=>{const t=Ar(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};var _r=wr;const ke=y,xr=(r,e,t,n,s)=>{typeof t=="string"&&(s=n,n=t,t=void 0);try{return new ke(r instanceof ke?r.version:r,t).inc(e,n,s).version}catch{return null}};var yr=xr;const je=W,Cr=(r,e)=>{const t=je(r,null,!0),n=je(e,null,!0),s=t.compare(n);if(s===0)return null;const o=s>0,i=o?t:n,u=o?n:t,c=!!i.prerelease.length;if(!!u.prerelease.length&&!c){if(!u.patch&&!u.minor)return"major";if(u.compareMain(i)===0)return u.minor&&!u.patch?"minor":"patch"}const a=c?"pre":"";return t.major!==n.major?a+"major":t.minor!==n.minor?a+"minor":t.patch!==n.patch?a+"patch":"prerelease"};var Dr=Cr;const Pr=y,br=(r,e)=>new Pr(r,e).major;var Ur=br;const Fr=y,Mr=(r,e)=>new Fr(r,e).minor;var Br=Mr;const Gr=y,kr=(r,e)=>new Gr(r,e).patch;var jr=kr;const Vr=W,Xr=(r,e)=>{const t=Vr(r,e);return t&&t.prerelease.length?t.prerelease:null};var Hr=Xr;const Ve=y,qr=(r,e,t)=>new Ve(r,t).compare(new Ve(e,t));var P=qr;const zr=P,Wr=(r,e,t)=>zr(e,r,t);var Kr=Wr;const Yr=P,Zr=(r,e)=>Yr(r,e,!0);var Qr=Zr;const Xe=y,Jr=(r,e,t)=>{const n=new Xe(r,t),s=new Xe(e,t);return n.compare(s)||n.compareBuild(s)};var Oe=Jr;const en=Oe,tn=(r,e)=>r.sort((t,n)=>en(t,n,e));var rn=tn;const nn=Oe,sn=(r,e)=>r.sort((t,n)=>nn(n,t,e));var on=sn;const an=P,cn=(r,e,t)=>an(r,e,t)>0;var ue=cn;const ln=P,un=(r,e,t)=>ln(r,e,t)<0;var Te=un;const fn=P,hn=(r,e,t)=>fn(r,e,t)===0;var Ot=hn;const dn=P,En=(r,e,t)=>dn(r,e,t)!==0;var Tt=En;const pn=P,mn=(r,e,t)=>pn(r,e,t)>=0;var Ae=mn;const vn=P,gn=(r,e,t)=>vn(r,e,t)<=0;var we=gn;const In=Ot,Rn=Tt,$n=ue,Nn=Ae,Ln=Te,Sn=we,On=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return In(r,t,n);case"!=":return Rn(r,t,n);case">":return $n(r,t,n);case">=":return Nn(r,t,n);case"<":return Ln(r,t,n);case"<=":return Sn(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};var At=On;const Tn=y,An=W,{safeRe:se,t:ie}=J,wn=(r,e)=>{if(r instanceof Tn)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?se[ie.COERCEFULL]:se[ie.COERCE]);else{const c=e.includePrerelease?se[ie.COERCERTLFULL]:se[ie.COERCERTL];let v;for(;(v=c.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||v.index+v[0].length!==t.index+t[0].length)&&(t=v),c.lastIndex=v.index+v[1].length+v[2].length;c.lastIndex=-1}if(t===null)return null;const n=t[2],s=t[3]||"0",o=t[4]||"0",i=e.includePrerelease&&t[5]?`-${t[5]}`:"",u=e.includePrerelease&&t[6]?`+${t[6]}`:"";return An(`${n}.${s}.${o}${i}${u}`,e)};var _n=wn;class xn{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(e,t)}return this}}var yn=xn,Ee,He;function b(){if(He)return Ee;He=1;const r=/\s+/g;class e{constructor(f,g){if(g=s(g),f instanceof e)return f.loose===!!g.loose&&f.includePrerelease===!!g.includePrerelease?f:new e(f.raw,g);if(f instanceof o)return this.raw=f.value,this.set=[[f]],this.formatted=void 0,this;if(this.options=g,this.loose=!!g.loose,this.includePrerelease=!!g.includePrerelease,this.raw=f.trim().replace(r," "),this.set=this.raw.split("||").map(E=>this.parseRange(E.trim())).filter(E=>E.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const E=this.set[0];if(this.set=this.set.filter(I=>!R(I[0])),this.set.length===0)this.set=[E];else if(this.set.length>1){for(const I of this.set)if(I.length===1&&F(I[0])){this.set=[I];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let f=0;f<this.set.length;f++){f>0&&(this.formatted+="||");const g=this.set[f];for(let E=0;E<g.length;E++)E>0&&(this.formatted+=" "),this.formatted+=g[E].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(f){const E=((this.options.includePrerelease&&m)|(this.options.loose&&K))+":"+f,I=n.get(E);if(I)return I;const p=this.options.loose,$=p?c[v.HYPHENRANGELOOSE]:c[v.HYPHENRANGE];f=f.replace($,Mt(this.options.includePrerelease)),i("hyphen replace",f),f=f.replace(c[v.COMPARATORTRIM],a),i("comparator trim",f),f=f.replace(c[v.TILDETRIM],d),i("tilde trim",f),f=f.replace(c[v.CARETTRIM],S),i("caret trim",f);let O=f.split(" ").map(w=>j(w,this.options)).join(" ").split(/\s+/).map(w=>Ft(w,this.options));p&&(O=O.filter(w=>(i("loose invalid filter",w,this.options),!!w.match(c[v.COMPARATORLOOSE])))),i("range list",O);const N=new Map,A=O.map(w=>new o(w,this.options));for(const w of A){if(R(w))return[w];N.set(w.value,w)}N.size>1&&N.has("")&&N.delete("");const C=[...N.values()];return n.set(E,C),C}intersects(f,g){if(!(f instanceof e))throw new TypeError("a Range is required");return this.set.some(E=>D(E,g)&&f.set.some(I=>D(I,g)&&E.every(p=>I.every($=>p.intersects($,g)))))}test(f){if(!f)return!1;if(typeof f=="string")try{f=new u(f,this.options)}catch{return!1}for(let g=0;g<this.set.length;g++)if(Bt(this.set[g],f,this.options))return!0;return!1}}Ee=e;const t=yn,n=new t,s=Se,o=fe(),i=le,u=y,{safeRe:c,t:v,comparatorTrimReplace:a,tildeTrimReplace:d,caretTrimReplace:S}=J,{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:K}=ce,R=h=>h.value==="<0.0.0-0",F=h=>h.value==="",D=(h,f)=>{let g=!0;const E=h.slice();let I=E.pop();for(;g&&E.length;)g=E.every(p=>I.intersects(p,f)),I=E.pop();return g},j=(h,f)=>(i("comp",h,f),h=Ct(h,f),i("caret",h),h=M(h,f),i("tildes",h),h=Pt(h,f),i("xrange",h),h=Ut(h,f),i("stars",h),h),x=h=>!h||h.toLowerCase()==="x"||h==="*",M=(h,f)=>h.trim().split(/\s+/).map(g=>yt(g,f)).join(" "),yt=(h,f)=>{const g=f.loose?c[v.TILDELOOSE]:c[v.TILDE];return h.replace(g,(E,I,p,$,O)=>{i("tilde",h,E,I,p,$,O);let N;return x(I)?N="":x(p)?N=`>=${I}.0.0 <${+I+1}.0.0-0`:x($)?N=`>=${I}.${p}.0 <${I}.${+p+1}.0-0`:O?(i("replaceTilde pr",O),N=`>=${I}.${p}.${$}-${O} <${I}.${+p+1}.0-0`):N=`>=${I}.${p}.${$} <${I}.${+p+1}.0-0`,i("tilde return",N),N})},Ct=(h,f)=>h.trim().split(/\s+/).map(g=>Dt(g,f)).join(" "),Dt=(h,f)=>{i("caret",h,f);const g=f.loose?c[v.CARETLOOSE]:c[v.CARET],E=f.includePrerelease?"-0":"";return h.replace(g,(I,p,$,O,N)=>{i("caret",h,I,p,$,O,N);let A;return x(p)?A="":x($)?A=`>=${p}.0.0${E} <${+p+1}.0.0-0`:x(O)?p==="0"?A=`>=${p}.${$}.0${E} <${p}.${+$+1}.0-0`:A=`>=${p}.${$}.0${E} <${+p+1}.0.0-0`:N?(i("replaceCaret pr",N),p==="0"?$==="0"?A=`>=${p}.${$}.${O}-${N} <${p}.${$}.${+O+1}-0`:A=`>=${p}.${$}.${O}-${N} <${p}.${+$+1}.0-0`:A=`>=${p}.${$}.${O}-${N} <${+p+1}.0.0-0`):(i("no pr"),p==="0"?$==="0"?A=`>=${p}.${$}.${O}${E} <${p}.${$}.${+O+1}-0`:A=`>=${p}.${$}.${O}${E} <${p}.${+$+1}.0-0`:A=`>=${p}.${$}.${O} <${+p+1}.0.0-0`),i("caret return",A),A})},Pt=(h,f)=>(i("replaceXRanges",h,f),h.split(/\s+/).map(g=>bt(g,f)).join(" ")),bt=(h,f)=>{h=h.trim();const g=f.loose?c[v.XRANGELOOSE]:c[v.XRANGE];return h.replace(g,(E,I,p,$,O,N)=>{i("xRange",h,E,I,p,$,O,N);const A=x(p),C=A||x($),w=C||x(O),Y=w;return I==="="&&Y&&(I=""),N=f.includePrerelease?"-0":"",A?I===">"||I==="<"?E="<0.0.0-0":E="*":I&&Y?(C&&($=0),O=0,I===">"?(I=">=",C?(p=+p+1,$=0,O=0):($=+$+1,O=0)):I==="<="&&(I="<",C?p=+p+1:$=+$+1),I==="<"&&(N="-0"),E=`${I+p}.${$}.${O}${N}`):C?E=`>=${p}.0.0${N} <${+p+1}.0.0-0`:w&&(E=`>=${p}.${$}.0${N} <${p}.${+$+1}.0-0`),i("xRange return",E),E})},Ut=(h,f)=>(i("replaceStars",h,f),h.trim().replace(c[v.STAR],"")),Ft=(h,f)=>(i("replaceGTE0",h,f),h.trim().replace(c[f.includePrerelease?v.GTE0PRE:v.GTE0],"")),Mt=h=>(f,g,E,I,p,$,O,N,A,C,w,Y)=>(x(E)?g="":x(I)?g=`>=${E}.0.0${h?"-0":""}`:x(p)?g=`>=${E}.${I}.0${h?"-0":""}`:$?g=`>=${g}`:g=`>=${g}${h?"-0":""}`,x(A)?N="":x(C)?N=`<${+A+1}.0.0-0`:x(w)?N=`<${A}.${+C+1}.0-0`:Y?N=`<=${A}.${C}.${w}-${Y}`:h?N=`<${A}.${C}.${+w+1}-0`:N=`<=${N}`,`${g} ${N}`.trim()),Bt=(h,f,g)=>{for(let E=0;E<h.length;E++)if(!h[E].test(f))return!1;if(f.prerelease.length&&!g.includePrerelease){for(let E=0;E<h.length;E++)if(i(h[E].semver),h[E].semver!==o.ANY&&h[E].semver.prerelease.length>0){const I=h[E].semver;if(I.major===f.major&&I.minor===f.minor&&I.patch===f.patch)return!0}return!1}return!0};return Ee}var pe,qe;function fe(){if(qe)return pe;qe=1;const r=Symbol("SemVer ANY");class e{static get ANY(){return r}constructor(a,d){if(d=t(d),a instanceof e){if(a.loose===!!d.loose)return a;a=a.value}a=a.trim().split(/\s+/).join(" "),i("comparator",a,d),this.options=d,this.loose=!!d.loose,this.parse(a),this.semver===r?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}parse(a){const d=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],S=a.match(d);if(!S)throw new TypeError(`Invalid comparator: ${a}`);this.operator=S[1]!==void 0?S[1]:"",this.operator==="="&&(this.operator=""),S[2]?this.semver=new u(S[2],this.options.loose):this.semver=r}toString(){return this.value}test(a){if(i("Comparator.test",a,this.options.loose),this.semver===r||a===r)return!0;if(typeof a=="string")try{a=new u(a,this.options)}catch{return!1}return o(a,this.operator,this.semver,this.options)}intersects(a,d){if(!(a instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new c(a.value,d).test(this.value):a.operator===""?a.value===""?!0:new c(this.value,d).test(a.semver):(d=t(d),d.includePrerelease&&(this.value==="<0.0.0-0"||a.value==="<0.0.0-0")||!d.includePrerelease&&(this.value.startsWith("<0.0.0")||a.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&a.operator.startsWith(">")||this.operator.startsWith("<")&&a.operator.startsWith("<")||this.semver.version===a.semver.version&&this.operator.includes("=")&&a.operator.includes("=")||o(this.semver,"<",a.semver,d)&&this.operator.startsWith(">")&&a.operator.startsWith("<")||o(this.semver,">",a.semver,d)&&this.operator.startsWith("<")&&a.operator.startsWith(">")))}}pe=e;const t=Se,{safeRe:n,t:s}=J,o=At,i=le,u=y,c=b();return pe}const Cn=b(),Dn=(r,e,t)=>{try{e=new Cn(e,t)}catch{return!1}return e.test(r)};var he=Dn;const Pn=b(),bn=(r,e)=>new Pn(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));var Un=bn;const Fn=y,Mn=b(),Bn=(r,e,t)=>{let n=null,s=null,o=null;try{o=new Mn(e,t)}catch{return null}return r.forEach(i=>{o.test(i)&&(!n||s.compare(i)===-1)&&(n=i,s=new Fn(n,t))}),n};var Gn=Bn;const kn=y,jn=b(),Vn=(r,e,t)=>{let n=null,s=null,o=null;try{o=new jn(e,t)}catch{return null}return r.forEach(i=>{o.test(i)&&(!n||s.compare(i)===1)&&(n=i,s=new kn(n,t))}),n};var Xn=Vn;const me=y,Hn=b(),ze=ue,qn=(r,e)=>{r=new Hn(r,e);let t=new me("0.0.0");if(r.test(t)||(t=new me("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){const s=r.set[n];let o=null;s.forEach(i=>{const u=new me(i.semver.version);switch(i.operator){case">":u.prerelease.length===0?u.patch++:u.prerelease.push(0),u.raw=u.format();case"":case">=":(!o||ze(u,o))&&(o=u);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${i.operator}`)}}),o&&(!t||ze(t,o))&&(t=o)}return t&&r.test(t)?t:null};var zn=qn;const Wn=b(),Kn=(r,e)=>{try{return new Wn(r,e).range||"*"}catch{return null}};var Yn=Kn;const Zn=y,wt=fe(),{ANY:Qn}=wt,Jn=b(),es=he,We=ue,Ke=Te,ts=we,rs=Ae,ns=(r,e,t,n)=>{r=new Zn(r,n),e=new Jn(e,n);let s,o,i,u,c;switch(t){case">":s=We,o=ts,i=Ke,u=">",c=">=";break;case"<":s=Ke,o=rs,i=We,u="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(es(r,e,n))return!1;for(let v=0;v<e.set.length;++v){const a=e.set[v];let d=null,S=null;if(a.forEach(m=>{m.semver===Qn&&(m=new wt(">=0.0.0")),d=d||m,S=S||m,s(m.semver,d.semver,n)?d=m:i(m.semver,S.semver,n)&&(S=m)}),d.operator===u||d.operator===c||(!S.operator||S.operator===u)&&o(r,S.semver))return!1;if(S.operator===c&&i(r,S.semver))return!1}return!0};var _e=ns;const ss=_e,is=(r,e,t)=>ss(r,e,">",t);var os=is;const as=_e,cs=(r,e,t)=>as(r,e,"<",t);var ls=cs;const Ye=b(),us=(r,e,t)=>(r=new Ye(r,t),e=new Ye(e,t),r.intersects(e,t));var fs=us;const hs=he,ds=P;var Es=(r,e,t)=>{const n=[];let s=null,o=null;const i=r.sort((a,d)=>ds(a,d,t));for(const a of i)hs(a,e,t)?(o=a,s||(s=a)):(o&&n.push([s,o]),o=null,s=null);s&&n.push([s,null]);const u=[];for(const[a,d]of n)a===d?u.push(a):!d&&a===i[0]?u.push("*"):d?a===i[0]?u.push(`<=${d}`):u.push(`${a} - ${d}`):u.push(`>=${a}`);const c=u.join(" || "),v=typeof e.raw=="string"?e.raw:String(e);return c.length<v.length?c:e};const Ze=b(),xe=fe(),{ANY:ve}=xe,Z=he,ye=P,ps=(r,e,t={})=>{if(r===e)return!0;r=new Ze(r,t),e=new Ze(e,t);let n=!1;e:for(const s of r.set){for(const o of e.set){const i=vs(s,o,t);if(n=n||i!==null,i)continue e}if(n)return!1}return!0},ms=[new xe(">=0.0.0-0")],Qe=[new xe(">=0.0.0")],vs=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===ve){if(e.length===1&&e[0].semver===ve)return!0;t.includePrerelease?r=ms:r=Qe}if(e.length===1&&e[0].semver===ve){if(t.includePrerelease)return!0;e=Qe}const n=new Set;let s,o;for(const m of r)m.operator===">"||m.operator===">="?s=Je(s,m,t):m.operator==="<"||m.operator==="<="?o=et(o,m,t):n.add(m.semver);if(n.size>1)return null;let i;if(s&&o){if(i=ye(s.semver,o.semver,t),i>0)return null;if(i===0&&(s.operator!==">="||o.operator!=="<="))return null}for(const m of n){if(s&&!Z(m,String(s),t)||o&&!Z(m,String(o),t))return null;for(const K of e)if(!Z(m,String(K),t))return!1;return!0}let u,c,v,a,d=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1,S=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1;d&&d.prerelease.length===1&&o.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(const m of e){if(a=a||m.operator===">"||m.operator===">=",v=v||m.operator==="<"||m.operator==="<=",s){if(S&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===S.major&&m.semver.minor===S.minor&&m.semver.patch===S.patch&&(S=!1),m.operator===">"||m.operator===">="){if(u=Je(s,m,t),u===m&&u!==s)return!1}else if(s.operator===">="&&!Z(s.semver,String(m),t))return!1}if(o){if(d&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===d.major&&m.semver.minor===d.minor&&m.semver.patch===d.patch&&(d=!1),m.operator==="<"||m.operator==="<="){if(c=et(o,m,t),c===m&&c!==o)return!1}else if(o.operator==="<="&&!Z(o.semver,String(m),t))return!1}if(!m.operator&&(o||s)&&i!==0)return!1}return!(s&&v&&!o&&i!==0||o&&a&&!s&&i!==0||S||d)},Je=(r,e,t)=>{if(!r)return e;const n=ye(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},et=(r,e,t)=>{if(!r)return e;const n=ye(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};var gs=ps;const ge=J,tt=ce,Is=y,rt=St,Rs=W,$s=Tr,Ns=_r,Ls=yr,Ss=Dr,Os=Ur,Ts=Br,As=jr,ws=Hr,_s=P,xs=Kr,ys=Qr,Cs=Oe,Ds=rn,Ps=on,bs=ue,Us=Te,Fs=Ot,Ms=Tt,Bs=Ae,Gs=we,ks=At,js=_n,Vs=fe(),Xs=b(),Hs=he,qs=Un,zs=Gn,Ws=Xn,Ks=zn,Ys=Yn,Zs=_e,Qs=os,Js=ls,ei=fs,ti=Es,ri=gs;var ni={parse:Rs,valid:$s,clean:Ns,inc:Ls,diff:Ss,major:Os,minor:Ts,patch:As,prerelease:ws,compare:_s,rcompare:xs,compareLoose:ys,compareBuild:Cs,sort:Ds,rsort:Ps,gt:bs,lt:Us,eq:Fs,neq:Ms,gte:Bs,lte:Gs,cmp:ks,coerce:js,Comparator:Vs,Range:Xs,satisfies:Hs,toComparators:qs,maxSatisfying:zs,minSatisfying:Ws,minVersion:Ks,validRange:Ys,outside:Zs,gtr:Qs,ltr:Js,intersects:ei,simplifyRange:ti,subset:ri,SemVer:Is,re:ge.re,src:ge.src,tokens:ge.t,SEMVER_SPEC_VERSION:tt.SEMVER_SPEC_VERSION,RELEASE_TYPES:tt.RELEASE_TYPES,compareIdentifiers:rt.compareIdentifiers,rcompareIdentifiers:rt.rcompareIdentifiers};const nt=ut(ni);var _;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.stax="stax",r.europa="europa"})(_||(_={}));const Re={[_.blue]:{id:_.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:r=>4*1024},[_.nanoS]:{id:_.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:r=>nt.lt(nt.coerce(r)??"","2.0.0")?4*1024:2*1024},[_.nanoX]:{id:_.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:r=>4*1024,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[_.nanoSP]:{id:_.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1533*1024,masks:[856686592],getBlockSize:r=>32},[_.stax]:{id:_.stax,productName:"Ledger Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1533*1024,masks:[857735168],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},[_.europa]:{id:_.europa,productName:"Ledger Flex",productIdMM:112,legacyUsbProductId:7,usbOnly:!1,memorySize:1533*1024,masks:[858783744],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-3004-0000-4c6564676572",notifyUuid:"13d63400-2c97-3004-0001-4c6564676572",writeUuid:"13d63400-2c97-3004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-3004-0003-4c6564676572"}]}};_.blue,_.nanoS,_.nanoSP,_.nanoX,_.stax,_.europa;const st=Object.values(Re),_t=11415,it=r=>{const e=st.find(s=>s.legacyUsbProductId===r);if(e)return e;const t=r>>8;return st.find(s=>s.productIdMM===t)},si=[],ot={};for(const r in Re){const e=Re[r],{bluetoothSpec:t}=e;if(t)for(let n=0;n<t.length;n++){const s=t[n];si.push(s.serviceUuid),ot[s.serviceUuid]=ot[s.serviceUuid.replace(/-/g,"")]={deviceModel:e,...s}}}const ii=[{vendorId:_t}];async function xt(){return await navigator.usb.requestDevice({filters:ii})}async function $e(){return(await navigator.usb.getDevices()).filter(e=>e.vendorId===_t)}async function oi(){const r=await $e();return r.length>0?r[0]:xt()}const ai=()=>Promise.resolve(!!navigator&&!!navigator.usb&&typeof navigator.usb.getDevices=="function"),ci=1,at=3,G=class G extends V{constructor(t,n){super();L(this,"device");L(this,"deviceModel");L(this,"channel",Math.floor(Math.random()*65535));L(this,"packetSize",64);L(this,"interfaceNumber");L(this,"_disconnectEmitted",!1);L(this,"_emitDisconnect",t=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",t))});this.device=t,this.interfaceNumber=n,this.deviceModel=it(t.productId)}static async request(){const t=await xt();return G.open(t)}static async openConnected(){const t=await $e();return t.length===0?null:G.open(t[0])}static async open(t){await t.open(),t.configuration===null&&await t.selectConfiguration(ci),await lt(t);const n=t.configurations[0].interfaces.find(({alternates:u})=>u.some(c=>c.interfaceClass===255));if(!n)throw new Pe("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.");const s=n.interfaceNumber;try{await t.claimInterface(s)}catch(u){throw await t.close(),new Pe(u.message)}const o=new G(t,s),i=u=>{t===u.device&&(navigator.usb.removeEventListener("disconnect",i),o._emitDisconnect(new Jt))};return navigator.usb.addEventListener("disconnect",i),o}async close(){await this.exchangeBusyPromise,await this.device.releaseInterface(this.interfaceNumber),await lt(this.device),await this.device.close()}async exchange(t){return await this.exchangeAtomicImpl(async()=>{const{channel:s,packetSize:o}=this;Ue("apdu","=> "+t.toString("hex"));const i=ur(s,o),u=i.makeBlocks(t);for(let a=0;a<u.length;a++)await this.device.transferOut(at,u[a]);let c,v;for(;!(c=i.getReducedResult(v));){const a=await this.device.transferIn(at,o),d=Buffer.from(a.data.buffer);v=i.reduceResponse(v,d)}return Ue("apdu","<= "+c.toString("hex")),c}).catch(s=>{throw s&&s.message&&s.message.includes("disconnected")?(this._emitDisconnect(s),new er(s.message)):s})}setScrambleKey(){}};L(G,"isSupported",ai),L(G,"list",$e),L(G,"listen",t=>{let n=!1;oi().then(o=>{if(!n){const i=it(o.productId);t.next({type:"add",descriptor:o,deviceModel:i}),t.complete()}},o=>{window.DOMException&&o instanceof window.DOMException&&o.code===18?t.error(new nr(o.message)):t.error(new tr(o.message))});function s(){n=!0}return{unsubscribe:s}});let ct=G;async function lt(r){try{await r.reset()}catch(e){console.warn(e)}}export{ct as default};
